<!DOCTYPE html><html lang="fr"><head><meta charset="UTF-8"><title>Les séries chronologiques de la salle D-316 ENSIMAG</title><script src="https://www.google.com/jsapi"></script><script>google.load("jquery","1.7.0")</script><script>function initialize(){var e=getDate();$("#date").text(e),setLinks(e);createLineChart("light",0,1e3,400,200,"gold"),createLineChart("sound",30,70,400,200,"blue"),createLineChart("temperature",0,40,400,200,"orange"),createLineChart("humidity",0,100,400,200,"cyan"),createLineChart("gasPressure",98,101,400,200,"green"),createLineChart("window2",0,2,400,200,"black"),createLineChart("motion",0,2,400,200,"purple"),update(e)}function getDateStr(e){return e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)}function setLinks(e){var t=getFileName(location.href),a='<form action="'+t+'" method="get">date : <input name="date" type="date" value="'+e+'"><input type="submit" value="aller"> </form>';$("#calendar").html(a);var i=new Date(e);i.setDate(i.getDate()+1);var r=getDateStr(i);i.setDate(i.getDate()-2);var n=getDateStr(i),o='<a href="'+t+"?date="+r+'"> demain =></a>';$("#next").html(o);var c='<a href="'+t+"?date="+n+'"> <= hier</a>';$("#prev").html(c)}function getFileName(e){return-1!=(e=e.substring(e.lastIndexOf("/")+1,e.length)).indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e}function getDate(){var e=new Date,t=e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2),a=location.href;if(-1!=a.indexOf("?")){for(var i=a.split("?")[1].split("&"),r=new Object,n=0;n<i.length;n++){var o=i[n].split("=");r[o[0]]=o[1]}r.date.match(/^\d\d\d\d-\d\d-\d\d$/)&&(t=r.date)}return t}function update(e){getData(e,"light",600),getData(e,"temperature",600),getData(e,"humidity",600),getData(e,"sound",60),getData(e,"gasPressure",600),getData(e,"window2",600),getData(e,"motion",6),setTimeout(function(e){update(e)},6e5,e)}function createLineChart(e,t,a,i,r,n){charts[e]=new google.visualization.LineChart(document.getElementById(e)),chartOpts[e]={min:t,max:a,width:i,height:r,"vAxis.viewWindowMode":"pretty",legend:{position:"none"},colors:[n]}}function getData(e,t,a){var i="http://133.30.159.3:8080/axis2/services/HBaseDataService/getData?since="+e+"T&until="+e+"Z&property="+t+"&step="+a;jQuery.ajax({url:i,type:"GET",dataType:"xml",cache:!1,success:function(a,i){if("null"==a);else{var r=new Array;r[0]=["Time",t];var n=1;$(a).find("list").each(function(){var e=$(this).find("time").text().substr(11,5),a=$(this).find("value").text(),i=getNumericValue(t,a);r[n]=[e,i],n++}),drawChart(e,t,r)}},error:function(e){}})}function getNumericValue(e,t){var a;switch(e){case"window0":case"window1":case"window2":a="open"==t?2:1;break;case"motion":a="true"==t?2:1;break;default:a=parseFloat(t)}return a}function drawChart(e,t,a){var i=google.visualization.arrayToDataTable(a),r=charts[t],n=chartOpts[t];n.title=t+" on "+e,r.draw(i,n)}google.load("visualization","1.0",{packages:["corechart","gauge"]}),google.setOnLoadCallback(initialize);var charts=new Object,chartOpts=new Object</script><style>#header{border-style:none none solid none;border-color:#dcdcdc;margin:0;padding:0 0 10px 10px}#footer{border-style:solid none none none;border-color:#dcdcdc;margin:0;padding:10px 0 0 10px}#content{overflow:hidden;padding:20px 0 20px 10px}#content p{text-align:center;font-size:150%;float:left;width:400px;margin:0 10px 10px 0}</style></head><body><div id="wrapper"><div id="header"><h1>Les séries chronologiques de capteurs</h1><p>dans D-316 ENSIMAG le <span id="date"></span></p><table border="0" width="100%" bgcolor="#D6F384"><tr><th width="33%" align="left" id="prev"></th><th width="34%" align="center" id="calendar"></th><th width="33%" align="right" id="next"></th></tr></table></div><div id="content"><p><span id="light"></span></p><p><span id="sound"></span></p><p><span id="temperature"></span></p><p><span id="humidity"></span></p><p><span id="gasPressure"></span></p><p><span id="window2"></span></p><p><span id="motion"></span></p></div><div id="footer">(C) 2015 Masahide Nakamura, CS27 Kobe University. All rights reserved.</div></div></body></html>